define("project/scripts/account/phoneNumberVerify",function(require,exports,module){var $=jQuery=require("jquery");var appUtils=require("appUtils"),service=require("serviceImp").getInstance(),global=require("gconfig").global,gconfig=require("gconfig"),layerUtils=require("layerUtils"),utils=require("utils"),validatorUtil=require("validatorUtil"),startCountDown=null,backmsg="",_pageId="#account_phoneNumberVerify",psw_id="",key=1,flag=false;function init(){console.log("sumTimeRegistered"+appUtils.getSStorageInfo("mobileNo")+"sumTime_unregistered_key get:"+appUtils.getSStorageInfo("sumTimeRegistered"+appUtils.getSStorageInfo("mobileNo")));$(_pageId+" .page").height($(window).height());$(_pageId+" .over_scroll").height($(window).height()-45).css({overflow:"auto"});var elements=_pageId+" .phoneNum";var backpage=appUtils.getPageParam("backUrl");console.log("backpage="+backpage);if(backpage=="account/phoneNumberVerify"){$(_pageId+" .getmsg").show();$(_pageId+" .cert_notice").hide();$(_pageId+" .time").hide();if(appUtils.getSStorageInfo("mobileNo")==""){$(_pageId+" .phoneNum").css({color:"#E3E3E3"}).val("请输入手机号码");}else{$(_pageId+" .phoneNum").css({color:"#2F2F2F"}).val(appUtils.getSStorageInfo("mobileNo"));}}}function bindPageEvent(){appUtils.bindEvent($(_pageId+" .header .icon_back"),function(){appUtils.pageInit("account/phoneNumberVerify","account/openAccount",{});});appUtils.bindEvent($(_pageId+" .header .icon_close"),function(){utils.layerTwoButton("退出系统？","确认","取消",function(){if(navigator.userAgent.indexOf("Android")>0){require("shellPlugin").callShellMethod("closeAppPlugin",null,null);}if(/\((iPhone|iPad|iPod)/i.test(navigator.userAgent)){window.location.href="backClientSide";}},function(){return false;});});appUtils.bindEvent($(_pageId+" .phoneNum"),function(){utils.dealIPhoneMaxLength(this,11);},"input");appUtils.bindEvent($(_pageId+" .fix_bot .ct_btn"),function(){appUtils.setSStorageInfo("tpbankFlg","0");appUtils.setSStorageInfo("idnoDD","");appUtils.setSStorageInfo("branchno","");var mobileNo=$(_pageId+" .phoneNum").val();if(mobileNo.length==0){layerUtils.iMsg(-1,"请输入手机号！");return;}if(isNaN(mobileNo)){layerUtils.iMsg(-1,"请输入正确数字格式的手机号！");return;}if(mobileNo.length<11){layerUtils.iMsg(-1,"请您输入11位的手机号！");return;}var telReg=!!mobileNo.match(/^(1\d{10})$/);if(telReg==false){layerUtils.iMsg(-1,"请输入正确格式的手机号！");return;}var param={"step":"isToukerUser","mobileNo":mobileNo};require("shellPlugin").callShellMethod("toukerServerPlugin",function(param){$.post(appToolsUrl+"touker/isToukerUser",utils.getParamJson(param),function(data){if(data.status=="001012"){var client_id=data.status.customerId;if(client_id!=null){appUtils.setSStorageInfo("khh",client_id);}else{appUtils.setSStorageInfo("khh","");}appUtils.pageInit("account/phoneNumberVerify","account/phoneCodeVerify");}else{if(data.status=="001011"){appUtils.pageInit("account/phoneNumberVerify","account/phoneToukerRegister");}else{layerUtils.iMsg(-1,"系统异常，请稍后重试！");}}});},function(data){},{"command":"requestUrlParamsEncoding","params":utils.jsonToParams(param)});});}function destroy(){if(startCountDown!=null){window.clearInterval(startCountDown);}if(backmsg==1){$(_pageId+" .getmsg").show();$(_pageId+" .cert_notice").hide();$(_pageId+" .time").hide();}else{$(_pageId+" .getmsg").show();$(_pageId+" .cert_notice").hide();$(_pageId+" .time").hide();$(_pageId+" .phoneNum").val("");$(_pageId+" .pic_code").val("");}service.destroy();}var phoneNumberVerify={"init":init,"bindPageEvent":bindPageEvent,"destroy":destroy};module.exports=phoneNumberVerify;});